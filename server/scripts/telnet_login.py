from telnetlib import Telnet
import sys

HOST = sys.argv[1]
USER = sys.argv[2]
passwords = sys.argv[3]
passwords = [val.strip() for val in passwords.split(',')]

for pwd in passwords:
    try:
        with Telnet(HOST, 23) as tn:
            tn.read_until(b"login: ")
            tn.write(USER.encode('ascii') + b"\n")
            tn.read_until(b"Password: ")
            tn.write(pwd.encode('ascii') + b"\n")

            res = tn.read_until(b"#", 8)
            if b"#" not in res:
                print("Fail", USER, pwd)
                continue
            else:
                tn.write(b"exit\n")
                print("Success", USER, pwd)
                break

    except EOFError:
        pass